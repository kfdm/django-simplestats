{% extends 'base.html' %}

{% block content %}
<h1>Widget</h1>

<table class="table table-sm table-bordered">
    <thead class="thead-dark">
        <tr>
            <th>Name</th>
            <th>Owner</th>
            <th>Type</th>
            <th>Description</th>
            <th>Public</th>
            <th colspan="3">Actions</th>
        </tr>
    </thead>
    <tr>
        <td><a href="{{widget.get_absolute_url}}">{{widget.name}}</a></td>
        <td>{{widget.owner}}</td>
        <td>{{widget.get_type_display}}</td>
        <td>{{widget.description}}</td>
        <td>{{widget.public}}</td>
        <td>
            <form id="new-widget" action="{% url 'stats:widget-subscribe' pk=widget.pk %}" method="POST">
                {% csrf_token %}
                <button class="btn btn-xm btn-success">Subscribe</button>
            </form>
        </td>
        <td>
            <a class="btn btn-xm btn-secondary"
                href="{% url 'api:widget-detail' pk=widget.pk format='json' %}">Embed</a>
        </td>
        <td>
            <a class="btn btn-xm btn-warning" href="{% url 'stats:widget-update' pk=widget.pk %}">Update</a>
        </td>
    </tr>
</table>


<table class="table table-sm table-bordered">
    <thead class="thead-dark">
        <tr>
            <th>Name</th>
            <th>Owner</th>
            <th>Type</th>
            <th>Description</th>
            <th>Public</th>
            <th colspan="3">Actions</th>
        </tr>
    </thead>
    {% for series in widget.series.all %}
    <tr>
        <td><input form="new-widget" name="series_id[]" value="{{series.pk}}" type="checkbox" /></td>
        <td><a href="{{series.get_absolute_url}}">{{series.name}}</a></td>
        <td>{{series.public}}</td>
        <td>{{series.value}}</td>
        <td>
            {% for label in series.label_set.all|dictsort:'name' %}
            <span class="badge badge-secondary">{{label.name}}:{{label.value}}</span>
            {% empty %}
            <p>No Labels</p>>
            {% endfor %}
        </td>
    </tr>
    {% empty %}
    <tr>
        <td colspan=6>No Series found</td>
    </tr>
    {% endfor %}
</table>

{% endblock %}